
### The Present

Venezuela is a country located at the northern end of South America. It occupies a roughly triangular area that is larger than the combined areas of France and Germany.

The economy of Venezuela is a market-based mixed economy based largely on the petroleum and manufacturing sectors, and has been in a state of total economic collapse since the mid-2010s. This has aled to a mass-exodus of people from the country which has been facing an economic and political turmoil since a long time.

```{r}
library(wbstats)
library(ggplot2)
library(tidyverse)
library(leaflet)
```

```{r}
gdp_data_ven <- wb(country = "VEN",
               indicator = c("NY.GDP.PCAP.KD.ZG") , startdate = 2000, enddate = 2017)
gdp_data_ven$date <- as.numeric(gdp_data_ven$date)
```

```{r}
gdp_data_ven %>%
  ggplot(aes(x = factor(date), y = value, group = 1)) + 
  geom_line(group = 1) + ylab("GDP per capita growth") +xlab(NULL) + ylab(NULL) +
  geom_hline(yintercept = 0, color = "red") +
  labs(
    title = "GDP per capita growth",
    subtitle = "2000 - 2014",
    caption = "source: World Bank, Global Poverty Working Group."
  )
  
```

The GDP per capita growth has been dipping since reaching its peak in 2004.

Let us see what the migration trends of the country has been.

```{r, warning=FALSE, message=FALSE}
# Importing migrant origin and destination numbers for venezuela
destination_data <- readxl::read_excel("Data/UN_MigrantStockByOriginAndDestination_2019.xlsx", sheet = 2, skip = 15, col_names = TRUE, trim_ws = TRUE)

# Subsetting origin to Venezuela
destination_data_ven <- destination_data %>%
  dplyr::filter(...3 == "Venezuela (Bolivarian Republic of)")

destination_data_ven$Total <- destination_data_ven$Total %>%
  as.numeric()

# Subsetting origin to Venezuela and also 2018. This will be used in the map.
destination_data_ven_2019 <- destination_data_ven %>%
  dplyr::filter(...1 == 2019)

# I am not interested in the first 9 columns. Only keeping columns which have data about the destination countries
destination_data_ven_2019 <- destination_data_ven_2019[c(10:241)]

# Making the table vertical- gather
destination_data_ven_2019 <- tidyr::gather(destination_data_ven_2019, key = "country", value = "value")

destination_data_ven_2019$value <- destination_data_ven_2019$value %>%
  as.numeric()
```

```{r}
options(scipen = 999)

destination_data_ven %>%
  ggplot() +
  geom_point(aes(x = factor(...1), y = Total)) +
  geom_line(aes(x = factor(...1), y = Total, group = 1)) +
  ylab(NULL) + xlab(NULL) + 
  geom_segment(aes(x = 1.1, xend = 1.1, y = 0, yend = 1000000), color = "blue", size = 0.2) +
  geom_label(aes(x = 1.1, y = 800000, label = "1992:\n Venezuela is\n3rd richest country"), size = 2.5) +
  geom_segment(aes(x = 2.9, xend = 2.9, y = 0, yend = 1000000), color = "blue", size = 0.2) +
  geom_label(aes(x = 2.9, y = 800000, label = "1999:\n Chavez begins\nfirst term"), size = 2.5) +
  geom_segment(aes(x = 3.3, xend = 3.3, y = 0, yend = 1010000), color = "blue", size = 0.2) +
  geom_label(aes(x = 3.3, y = 500000, label = "2002:\n Armed forces\nrebel"), size = 2.5) +
  geom_segment(aes(x = 5.5, xend = 5.5, y = 0, yend = 1385000), color = "blue", size = 0.2) +
  geom_label(aes(x=5.5, y=500000, label="2013:\nPresident Chavez dies.\nMaduro elected"),size=2.5) +
  geom_segment(aes(x = 5.8, xend = 5.8, y = 0, yend = 1400000), color = "blue", size = 0.2) +
  geom_label(aes(x=6, y=1100000, label="2014:\nCentral Bank\n confirms recession"),size=2.5) +
  labs(
    title = "Evolution of migration",
    subtitle = "1990 - 2019",
    caption = "source: World Bank, Global Poverty Working Group."
  )
```

A very large number of migrants from Venezuela are refugees and asylum seekers who have moved to other countries to search for a safe haven.

This map shows the destinations of the refugees and asylum seekers from Venezuela in the year 2019.

```{r, message=FALSE, verbose=FALSE}
world <- rgdal::readOGR("Data/country_centroids_az8/country_centroids_az8.shp", verbose = FALSE)

world_ven <- merge(world, destination_data_ven_2019, by.x = "sovereignt", by.y = "country", all.x = TRUE)

world_ven_ven <- world_ven@data %>%
  dplyr::filter(sovereignt == "Venezuela")

content <- sprintf("<strong>%s</strong><br/>%g",
                  world_ven$sovereignt,
                  world_ven$value) %>% lapply(htmltools::HTML)

group <- c()
lng <- c()
lat <- c()
groupval = 1

for(i in 1:nrow(world_ven)){
  # If there is a connection between destination and origin country
  if(!is.na(world_ven$value[i])){
    # Enter origin country first
    group <- c(group, groupval)
    lat <- c(lat, world_ven_ven$Latitude)
    lng <- c(lng, world_ven_ven$Longitude)
    
    # Enter destination country for same groupvalue
    group <- c(group, groupval)
    lat <- c(lat, world_ven$Latitude[i])
    lng <- c(lng, world_ven$Longitude[i])
    
    # Increment group val
    groupval = groupval + 1
  }
}

df_ven <- data.frame(group=group, lng=lng, lat=lat)

pal <- colorNumeric("Blues", df_ven$group)

leaflet::leaflet() %>%
  setView(-66.1818412311, 7.12422421273, zoom = 2) %>%
  #addProviderTiles(providers$MapBox, options = providerTileOptions(minZoom = 2, maxZoom = 5)) %>%
  addTiles(options = providerTileOptions(minZoom = 2, maxZoom = 5)) %>%
  addCircles(data = world_ven,
             lat = world_ven$Latitude,
             lng = world_ven$Longitude,
             radius = world_ven$value,
             fillColor = world_ven$value,
             opacity = 0.8, fillOpacity = 0.7,
             popup = content, label = content, labelOptions(
                    style = list("font-weight" = "normal", padding = "3px 8px"),
                    textsize = "15px",
                    direction = "auto")) %>%
  addPolylines(data = df_ven,
               lng = df_ven$lng,
               lat = df_ven$lat,
               group = df_ven$group,
               color = pal(df_ven$group),
               opacity = 0.1,
               weight = 1,
               fillOpacity = 0.25,
               fillColor = pal(df_ven$group))
  
  
```




Word-Cloud for Article Coverages: Venezuela

```{r, message=FALSE, warning=FALSE, verbose=FALSE}
library(dplyr)
library(stringi)
library(tm)
library(SnowballC)
library(wordcloud)
library(RColorBrewer)
library(corpus)
library(purrr)
library(gower)
library(lme4)
library(multcomp)
library(mvtnorm)
library(corpustools)
```

```{r, message=FALSE, warning=FALSE, verbose=FALSE}
text2 <- readLines("Data/venezuela_v1.txt")
cloud2 <- Corpus(VectorSource(text2))
```
```{r, message=FALSE, warning=FALSE, verbose=FALSE}
removeNumPunct <- function(x) {
  gsub("[^[:alpha:][:space:]]*", "", x)
}
removeAllCaps <- function(x) {
  gsub("\b[A-Z]+\b", "", x)
}


clean_corpus <- function(corpus) {
  corpus <- tm_map(corpus, removePunctuation)
  corpus <- tm_map(corpus, content_transformer(removeAllCaps))
  corpus <- tm_map(corpus, content_transformer(tolower))
  #adding too common and not insightful words to the stopwords list
  corpus <- tm_map(corpus, removeWords, c("syria","syrian","south","sudan","venezuela","venezuelas","venezuelans","venezuelan","year","years","one","two","three","later","since","month","months","didnt","first","second","third","back","even","now","among","may","get","day","yet","say","country","countries","countrys","president","middle","many","still","says", "bus","left","like","want", "sudanese","sudans","refugee", stopwords("en")))
  corpus <- tm_map(corpus, removeNumbers)
  corpus <- tm_map(corpus, content_transformer(removeNumPunct))
  corpus <- tm_map(corpus, stripWhitespace)
  return(corpus)
}
```


```{r, verbose=FALSE, warning=FALSE, message=FALSE}
suc_clean2 <- clean_corpus(cloud2)

suc_tdm2 <- TermDocumentMatrix(suc_clean2)

suc_m2 <- as.matrix(suc_tdm2)

suc_v2 <- sort(rowSums(suc_m2), decreasing = TRUE)

suc_d2 <- data.frame(word = names(suc_v2), freq = suc_v2)
```
```{r, message=FALSE, warning=FALSE, verbose=FALSE}

set.seed(1234)
wordcloud(
  words = suc_d2$word,
  freq = suc_d2$freq,scale = c(2, 0.4),
  min.freq = 5,
  max.words = 100,
  random.order = FALSE,
  rot.per = 0.3,
  colors = brewer.pal(8, "Dark2")
)
```



### The Future
```{r, echo=FALSE}
library(tidyverse)
library(dplyr)
library(ggplot2)
library(ggthemes)
library(plotly)
library(DT)

dfpop = read.csv("Data/WPP2019_TotalPopulationBySex.csv")
```

*Population development in Venezuela (Medium vs. zero-migration)*
```{r}
dfpop_venezuela <- dfpop %>%
  filter(Variant %in% c("Medium", "Zero migration")) %>%
  filter(Location == "Venezuela (Bolivarian Republic of)")
plot_popvenezuela <- ggplot(data=dfpop_venezuela, aes(x=Time, y=PopTotal, fill=Variant, color=Variant)) + geom_line()
plot_popvenezuela
```
This graph illustrates the total population (y-axis) development of the Bolivarian Republic of Venezuela over time (x-axis). In the period from 1950 to 2019 the population is increasing constantly with the exception from 2015 to 2019. At that time Venezuela suffered from a dramatic financial crisis, which might have had an effect on the total population. From 2020 to 2100 the graph includes two different curves. The red one is the medium projection variant, which the most popular type because it is based on the median of all trajectories based on a probabilistic model. The blue line describes the zero migration variant, which assumes that there is no international migration and projects the population based on that. In general the curves show that the assumptions are that more people are entering the country than people are leaving it. However, the curves almost noticably interesect in 2100. It is a very far ahead projection of population of course, but it is interesting that both curves seem to decrease from around 2060 on.