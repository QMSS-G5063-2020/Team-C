---
title: "southsudan"
output: html_document
---

Made up of the 10 southern-most states of Sudan, South Sudan is one of the most diverse countries in Africa. It is home to over 60 different major ethnic groups, and the majority of its people follow traditional religions.

South Sudan gained independence from Sudan on 9 July 2011 as the outcome of a 2005 agreement that ended Africa's longest-running civil war. Independence did not bring conflict in South Sudan to an end. Civil war broke out in 2013 when the president fell out with his then vice president, leading to a conflict that has displaced some 4 million people.

```{r}
library(wbstats)
library(ggplot2)
library(tidyverse)
library(readxl)
library(dplyr)
library(leaflet)
```




```{r}
pov_data_ssu <- wbstats::wb(country = "SSD", 
                            indicator = "SI.POV.NAHC", startdate = 2009, enddate = 2020, return_wide = TRUE)
pov_data_ssu$date <- pov_data_ssu$date %>%
  as.numeric()

ggplot2::ggplot(pov_data_ssu) +
  ggplot2::geom_bar(aes(x = factor(date), y = SI.POV.NAHC), stat = "identity") +
  xlab(NULL) + ylab(NULL) +
  labs(title = "%age of people living below poverty line",
       caption = "source: World Bank, Global Poverty Working Group.", parse = TRUE)

```

```{r}
gdp_data_ssu <- wbstats::wb(country = "SSD",
               indicator = c("NY.GDP.PCAP.KD.ZG") , startdate = 2000, enddate = 2017)
gdp_data_ssu$date <- as.numeric(gdp_data_ssu$date)
```

```{r}
gdp_data_ssu %>%
  ggplot(aes(x = factor(date), y = value, group = 1)) + 
  geom_line(group = 1) + ylab("GDP per capita growth") +xlab(NULL) + ylab(NULL) +
  geom_hline(yintercept = 0, color = "red") +
  labs(title = "GDP Growth Rate",
       subtitle = "Movement of GDP per capita growth rate from 2009-2015",
       caption = "source: World Bank, Global Poverty Working Group.", parse = TRUE)
```


```{r, warning=FALSE, message=FALSE}
# Importing migrant origin and destination numbers for South Sudan
destination_data <- readxl::read_excel("Data/UN_MigrantStockByOriginAndDestination_2019.xlsx", sheet = 2, skip = 15, col_names = TRUE, trim_ws = TRUE)

# Subsetting origin to South Sudan
destination_data_ssu <- destination_data %>%
  dplyr::filter(...3 == "South Sudan")

destination_data_ssu$Total <- destination_data_ssu$Total %>%
  as.numeric()

# Subsetting origin to Syria and also 2018. This will be used in the map.
destination_data_ssu_2019 <- destination_data_ssu %>%
  dplyr::filter(...1 == 2019)

# I am not interested in the first 9 columns. Only keeping columns which have data about the destination countries
destination_data_ssu_2019 <- destination_data_ssu_2019[c(10:241)]

# Making the table vertical- gather
destination_data_ssu_2019 <- tidyr::gather(destination_data_ssu_2019, key = "country", value = "value")

destination_data_ssu_2019$value <- destination_data_ssu_2019$value %>%
  as.numeric()
```

```{r, warning=FALSE}

destination_data_ssu %>%
  # Removing rows without data
  filter(...1 >= 2010) %>%
  ggplot() +
  geom_point(aes(x = factor(...1), y = Total)) +
  geom_line(aes(x = factor(...1), y = Total, group = 1)) +
  ylab(NULL) + xlab(NULL) +
  geom_segment(aes(x = 1.2, xend = 1.2, y = 0, yend = 381000), color = "blue", size = 0.2) +
  geom_label(aes(x = 1.2, y = 200000, label = "2011:\n South Sudan\nis born"), size = 2.5) +
  geom_segment(aes(x = 1.6, xend = 1.6, y = 0, yend = 602000), color = "blue", size = 0.2) +
  geom_label(aes(x=1.6, y=450000, label="2013:\nCivil War\nerupts"),size=2.5) +
  geom_segment(aes(x = 2.2, xend = 2.2, y = 0, yend = 855000), color = "blue", size = 0.2) +
  geom_label(aes(x=2.2, y=300000, label="2016:\nUN claims ethnic\n cleansing in S. Sudan"),size=2.5) +
  labs(
    title = "Evolution of migration",
    subtitle = "2010 - 2019",
    caption = "source: World Bank, Global Poverty Working Group."
  )

```

A very large number of migrants from South Sudan are refugees and asylum seekers who have moved to other countries to search for a safe haven.

This map shows the destinations of the refugees and asylum seekers from South Sudan in the year 2019.
```{r}
# importing the country centroid data
world <- rgdal::readOGR("Data/country_centroids_az8/country_centroids_az8.shp", verbose = FALSE)

# Merging data with shape file
world_ssu <- merge(world, destination_data_ssu_2019, by.x = "sovereignt", by.y = "country", all.x = TRUE)

world_ssu_ssu <- world_ssu@data %>%
  filter(sovereignt == "South Sudan")

group <- c()
lng <- c()
lat <- c()
groupval = 1

for(i in 1:nrow(world_ssu)){
  # If there is a connection between destination and origin country
  if(!is.na(world_ssu$value[i])){
    # Enter origin country first
    group <- c(group, groupval)
    lat <- c(lat, world_ssu_ssu$Latitude)
    lng <- c(lng, world_ssu_ssu$Longitude)
    
    # Enter destination country for same groupvalue
    group <- c(group, groupval)
    lat <- c(lat, world_ssu$Latitude[i])
    lng <- c(lng, world_ssu$Longitude[i])
    
    # Increment group val
    groupval = groupval + 1
  }
}

df <- data.frame(group=group, lng=lng, lat=lat)

pal <- colorNumeric("Blues", df$group)

content <- sprintf("<strong>%s</strong><br/>%g",
                  world_ssu$sovereignt,
                  world_ssu$value) %>% lapply(htmltools::HTML)

leaflet::leaflet() %>%
  setView(6.8770, 31.34165036, zoom = 4) %>%
  addTiles(options = providerTileOptions(minZoom = 3, maxZoom = 5)) %>%
  addCircles(data = world_ssu,
             lat = world_ssu$Latitude,
             lng = world_ssu$Longitude,
             radius = world_ssu$value,
             fillColor = world_ssu$value,
             opacity = 0.8, fillOpacity = 0.7,
             popup = content, label = content, labelOptions(
                    style = list("font-weight" = "normal", padding = "3px 8px"),
                    textsize = "15px",
                    direction = "auto")) %>%
  addPolylines(data = df,
               lng = df$lng,
               lat = df$lat,
               group = df$group,
               color = pal(df$group),
               opacity = 0.3,
               weight = 1)

```